
<% if (@key == "ranks") %>
        [<% @json.each_with_index do |element,i| %>
            {
                "attr":
                {
                    "id":"taxon_<%= element.name %>"

                },
                "data":"<%=h element.name %>",
                "icon" : "/images/jstree/file.png",
                "state": "<%= TaxonConcept.find_all_by_rank(element.name).empty? ? "open" : "closed" %>"
            }<%= "," if i < @json.count-1 %>
            <% end -%>
        ]

 <%  elsif (@key.include? '_')
    if @key.split('_').first() == "taxon" %>
     [<% @json.each_with_index do |element,i| %>
            {
                "attr":
                {
                    "id":"node_<%= element.id %>"
                },
                "data":"<%=h element.taxon_name.scientific_name %>",
                "state":"closed"
            }<%= "," if i < @json.count-1 %>
            <% end -%>
       ]
       <% elsif @key.split('_').first() == "node" %>
          [<% @json.each_with_index do |element,i| %>
            {
                "attr":
                {
                    "id":"node_<%= element.id %>"
                },
                "data":"<%=h element.taxon_name.scientific_name %>",
                "state":"closed"
            }<%= "," if i < @json.count-1 %>
            <% end -%>
       ]
  <% end -%>
<% end -%>